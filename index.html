<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuizWise - Enterprise Quiz Platform</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/styles.css">
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-analytics.js";
        import { getAuth } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD6-YX7lqxOBDM2fq5hdrWbVTiaEifrqZI",
            authDomain: "quiz-app-c2875.firebaseapp.com",
            projectId: "quiz-app-c2875",
            storageBucket: "quiz-app-c2875.firebasestorage.app",
            messagingSenderId: "183949470045",
            appId: "1:183949470045:web:5fe2ca1b0202cd919960b4",
            measurementId: "G-FPXR739ZML"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Make Firebase services globally available
        window.firebase = {
            app: app,
            auth: auth,
            db: db,
            analytics: analytics
        };
        
        window.auth = auth;
        window.db = db;
        window.analytics = analytics;
        
        console.log('Firebase initialized successfully');
    </script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#home">
                <i class="fas fa-brain me-2"></i>QuizWise
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#quizzes">Quizzes</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#leaderboard">Leaderboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#ai-generator">AI Generator</a>
                    </li>
                </ul>
                
                <div class="navbar-nav">
                    <div id="auth-buttons" class="d-flex gap-2">
                        <button class="btn btn-outline-primary" onclick="showLoginModal()">Login</button>
                        <button class="btn btn-accent" onclick="showRegisterModal()">Sign Up</button>
                    </div>
                    <div id="user-menu" class="dropdown d-none">
                        <button class="btn btn-outline-light dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user me-2"></i><span id="user-name"></span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#profile"><i class="fas fa-user me-2"></i>Profile</a></li>
                            <li><a class="dropdown-item" href="#" onclick="showUserHistory()"><i class="fas fa-history me-2"></i>My Quiz History</a></li>
                            <li><a class="dropdown-item" href="#" onclick="showMyResults()"><i class="fas fa-chart-line me-2"></i>My Results</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-warning" href="#" onclick="clearAppLocalStorage()"><i class="fas fa-trash-alt me-2"></i>Clear Local Data</a></li>
                            <li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content">
        <!-- Home Section -->
        <section id="home" class="hero-section">
            <div class="container">
                <div class="row align-items-center min-vh-100">
                    <div class="col-lg-6">
                        <div class="hero-content">
                            <h1 class="display-4 fw-bold mb-4">
                                Master Knowledge with 
                                <span class="text-gradient">AI-Powered Quizzes</span>
                            </h1>
                            <p class="lead mb-5">
                                Challenge yourself with intelligent quizzes, get instant AI feedback, 
                                and compete with learners worldwide on QuizWise.
                            </p>
                            <div class="d-flex gap-3 flex-wrap">
                                <button class="btn btn-accent btn-lg" onclick="scrollToSection('quizzes')">
                                    <i class="fas fa-play me-2"></i>Start Quiz
                                </button>
                                <button class="btn btn-outline-primary btn-lg" onclick="scrollToSection('ai-generator')">
                                    <i class="fas fa-robot me-2"></i>AI Generator
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="hero-animation">
                            <div class="quiz-card-demo">
                                <div class="demo-card">
                                    <div class="card-header">
                                        <h5><i class="fas fa-brain me-2"></i>JavaScript Fundamentals</h5>
                                        <span class="badge bg-success">Beginner</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="progress mb-3">
                                            <div class="progress-bar bg-primary" style="width: 65%"></div>
                                        </div>
                                        <p>What is the difference between let and var?</p>
                                        <div class="demo-options">
                                            <div class="option correct">âœ“ Block vs Function scope</div>
                                            <div class="option">Hoisting behavior</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quiz Categories Section -->
        <section id="quizzes" class="py-5">
            <div class="container">
                <div class="text-center mb-5">
                    <h2 class="display-5 fw-bold mb-3">Choose Your Challenge</h2>
                    <p class="lead text-muted">Select from our diverse range of quiz categories</p>
                </div>
                
                <div class="row" id="quiz-categories">
                    <!-- Categories will be loaded dynamically -->
                </div>
            </div>
        </section>

        <!-- AI Generator Section -->
        <section id="ai-generator" class="py-5">
            <div class="container">
                <div class="text-center mb-5">
                    <h2 class="display-5 fw-bold mb-3">AI Quiz Generator</h2>
                    <p class="lead text-muted">Create custom quizzes with artificial intelligence</p>
                </div>
                
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="card generator-card">
                            <div class="card-body p-5">
                                <form id="ai-generator-form">
                                    <div class="mb-4">
                                        <label for="quiz-topic" class="form-label">Quiz Topic</label>
                                        <input type="text" class="form-control" id="quiz-topic" 
                                               placeholder="e.g., JavaScript, Python, Machine Learning" 
                                               minlength="3" maxlength="100"
                                               pattern="[a-zA-Z0-9\s\-_]+"
                                               required>
                                        <div class="form-text">Enter a topic for your quiz (3-100 characters, letters, numbers, spaces, hyphens, and underscores only)</div>
                                    </div>
                                    
                                    <div class="row mb-4">
                                        <div class="col-md-6">
                                            <label for="difficulty" class="form-label">Difficulty Level</label>
                                            <select class="form-select" id="difficulty" required>
                                                <option value="">Select Difficulty</option>
                                                <option value="beginner">Beginner</option>
                                                <option value="intermediate">Intermediate</option>
                                                <option value="advanced">Advanced</option>
                                            </select>
                                            <div class="form-text">Choose the difficulty level for your quiz</div>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="question-count" class="form-label">Number of Questions</label>
                                            <select class="form-select" id="question-count" required>
                                                <option value="">Select Count</option>
                                                <option value="5">5 Questions</option>
                                                <option value="10">10 Questions</option>
                                                <option value="15">15 Questions</option>
                                                <option value="20">20 Questions</option>
                                            </select>
                                            <div class="form-text">Choose how many questions to generate</div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="question-types" class="form-label">Question Types</label>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="multiple-choice" value="multiple-choice" checked>
                                                    <label class="form-check-label" for="multiple-choice">Multiple Choice</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="true-false" value="true-false">
                                                    <label class="form-check-label" for="true-false">True/False</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="open-ended" value="open-ended">
                                                    <label class="form-check-label" for="open-ended">Open Ended</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-text">Select at least one question type</div>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-submit w-100">
                                        <i class="fas fa-magic me-2"></i>Generate Quiz
                                    </button>
                                </form>
                                
                                <div id="generation-progress" class="mt-4 d-none">
                                    <div class="text-center">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                        <p class="mt-3">AI is generating your quiz...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Leaderboard Section -->
        <section id="leaderboard" class="py-5">
            <div class="container">
                <div class="text-center mb-5">
                    <h2 class="display-5 fw-bold mb-3">Global Leaderboard</h2>
                    <p class="lead text-muted">See how you rank against other quiz masters</p>
                </div>
                
                <div class="row">
                    <div class="col-lg-8 mx-auto">
                        <div class="card leaderboard-card">
                            <div class="card-header">
                                <ul class="nav nav-pills card-header-pills justify-content-center">
                                    <li class="nav-item">
                                        <a class="nav-link active" href="#" data-period="daily">Daily</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="#" data-period="weekly">Weekly</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="#" data-period="monthly">Monthly</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="#" data-period="alltime">All Time</a>
                                    </li>
                                </ul>
                            </div>
                            <div class="card-body">
                                <div id="leaderboard-content">
                                    <!-- Leaderboard content will be loaded dynamically -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Profile Section -->
        <section id="profile" class="py-5 d-none">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="card leaderboard-card">
                            <div class="card-header">
                                <h5 class="card-title mb-0"><i class="fas fa-id-card me-2"></i>My Profile</h5>
                            </div>
                            <div class="card-body">
                                <form id="profileForm">
                                    <div class="row g-3">
                                        <div class="col-sm-6">
                                            <label for="profileName" class="form-label">Full Name</label>
                                            <input type="text" class="form-control" id="profileName" placeholder="Your full name" pattern="[a-zA-Z\s\-'\.]{2,50}" minlength="2" maxlength="50" required>
                                            <div class="form-text">2-50 characters; letters, spaces, hyphens, apostrophes and periods only.</div>
                                        </div>
                                        <div class="col-sm-6">
                                            <label for="profileUsername" class="form-label">Username</label>
                                            <input type="text" class="form-control" id="profileUsername" placeholder="Your username" pattern="[a-zA-Z0-9_]{3,20}" minlength="3" maxlength="20" required>
                                            <div class="form-text">This name appears on the leaderboard.</div>
                                        </div>
                                        <div class="col-sm-12">
                                            <label for="profileEmail" class="form-label">Email</label>
                                            <input type="email" class="form-control" id="profileEmail" readonly>
                                            <div class="form-text">Email changes are managed via your auth provider.</div>
                                        </div>
                                    </div>
                                    <div class="d-flex gap-2 mt-4">
                                        <button type="submit" class="btn btn-accent"><i class="fas fa-save me-2"></i>Save Changes</button>
                                        <button type="button" class="btn btn-outline-primary" onclick="clearAppLocalStorage()"><i class="fas fa-broom me-2"></i>Clear Local Data</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Quiz Modal -->
    <div class="modal fade" id="quizModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="d-flex justify-content-between w-100 align-items-center">
                        <h5 class="modal-title" id="quizTitle">Quiz Title</h5>
                        <div class="quiz-timer">
                            <i class="fas fa-clock me-2"></i>
                            <span id="timer">00:00</span>
                        </div>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="quiz-progress mb-4">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Progress</span>
                            <span id="question-counter">1 / 10</span>
                        </div>
                        <div class="progress">
                            <div class="progress-bar" id="quiz-progress-bar" style="width: 10%"></div>
                        </div>
                    </div>
                    
                    <div id="quiz-content">
                        <!-- Quiz questions will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="prev-question" disabled>
                        <i class="fas fa-arrow-left me-2"></i>Previous
                    </button>
                    <button type="button" class="btn btn-primary" id="next-question">
                        Next<i class="fas fa-arrow-right ms-2"></i>
                    </button>
                    <button type="button" class="btn btn-submit d-none" id="submit-quiz">
                        <i class="fas fa-paper-plane me-2"></i>Submit Quiz
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Modals -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Login to QuizWise</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="loginEmail" 
                                   placeholder="Enter your email (e.g., user@gmail.com)" 
                                   pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
                                   required>
                            <div class="form-text">Please enter a valid email address</div>
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="loginPassword" 
                                   placeholder="Enter your password" 
                                   minlength="6"
                                   required>
                            <div class="form-text">Password must be at least 6 characters long</div>
                        </div>
                        <button type="submit" class="btn btn-accent w-100">Login</button>
                    </form>
                    <div class="text-center mt-3">
                        <p>Don't have an account? <a href="#" onclick="showRegisterModal()">Sign up here</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Join QuizWise</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="registerForm">
                        <div class="mb-3">
                            <label for="registerName" class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="registerName" 
                                   placeholder="Enter your full name (e.g., John Doe)" 
                                   pattern="[a-zA-Z\s\-'\.]{2,50}"
                                   minlength="2" maxlength="50"
                                   required>
                            <div class="form-text">2-50 characters, letters, spaces, hyphens, apostrophes, and periods only</div>
                        </div>
                        <div class="mb-3">
                            <label for="registerUsername" class="form-label">Username</label>
                            <input type="text" class="form-control" id="registerUsername" 
                                   placeholder="Enter username (e.g., john_doe123)" 
                                   pattern="[a-zA-Z0-9_]{3,20}"
                                   minlength="3" maxlength="20"
                                   required>
                            <div class="form-text">3-20 characters, letters, numbers, and underscores only. This will be your display name in leaderboards</div>
                        </div>
                        <div class="mb-3">
                            <label for="registerEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="registerEmail" 
                                   placeholder="Enter your email (e.g., user@gmail.com)" 
                                   pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
                                   required>
                            <div class="form-text">Please enter a valid email address</div>
                        </div>
                        <div class="mb-3">
                            <label for="registerPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="registerPassword" 
                                   placeholder="Enter password (min 6 characters)" 
                                   minlength="6"
                                   required>
                            <div class="form-text">Password must be at least 6 characters long</div>
                        </div>
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirm Password</label>
                            <input type="password" class="form-control" id="confirmPassword" 
                                   placeholder="Confirm your password" 
                                   minlength="6"
                                   required>
                            <div class="form-text">Please confirm your password</div>
                        </div>
                        <button type="submit" class="btn btn-accent w-100">Create Account</button>
                    </form>
                    <div class="text-center mt-3">
                        <p>Already have an account? <a href="#" onclick="showLoginModal()">Login here</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal fade" id="resultsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Quiz Results</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="results-content">
                    <!-- Results will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-accent" onclick="shareResults()">Share Results</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quiz History Modal -->
    <div class="modal fade" id="quizHistoryModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">My Quiz History</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>Quiz ID</th>
                                    <th>Topic</th>
                                    <th>Difficulty</th>
                                    <th>Questions</th>
                                    <th>Score</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody id="quizHistoryTableBody">
                                <!-- History will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div class="modal fade" id="historyModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-history me-2"></i>My Quiz History</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="history-content">
                    <!-- History will be injected here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- My Results Modal -->
    <div class="modal fade" id="myResultsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-chart-line me-2"></i>My Results</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="my-results-content">
                    <!-- Results summary will be injected -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js for analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="assets/js/firebase-config.js"></script>
    <script src="assets/js/auth.js"></script>
    
    <script src="assets/js/ai-generator.js"></script>
    <script src="assets/js/leaderboard.js"></script>
    <script src="assets/js/main.js"></script>
</body>
</html>